<?xml version="1.0" encoding="UTF-8"?>
<report xmlns="http://www.eclipse.org/birt/2005/design" version="3.2.23" id="1">
    <property name="createdBy">Eclipse BIRT 设计器 V4.5.0.v201506092134 构建 &lt;@建立@></property>
    <property name="units">in</property>
    <property name="iconFile">/templates/blank_report.gif</property>
    <property name="bidiLayoutOrientation">ltr</property>
    <property name="imageDPI">72</property>
    <parameters>
        <scalar-parameter name="id" id="29">
            <property name="hidden">true</property>
            <text-property name="promptText">编号</text-property>
            <property name="valueType">static</property>
            <property name="dataType">integer</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant">0</value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="JNDIName" id="30">
            <property name="hidden">true</property>
            <text-property name="promptText">JNDI</text-property>
            <property name="valueType">static</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant">""</value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
    </parameters>
    <data-sources>
        <script-data-source name="DS" id="4"/>
    </data-sources>
    <data-sets>
        <script-data-set name="dataDetail" id="5">
            <list-property name="resultSetHints">
                <structure>
                    <property name="position">1</property>
                    <property name="name">formid</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">name</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">3</property>
                    <property name="name">gender</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">4</property>
                    <property name="name">totalmark</property>
                    <property name="dataType">float</property>
                </structure>
                <structure>
                    <property name="position">5</property>
                    <property name="name">seq</property>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="position">6</property>
                    <property name="name">itemcategory</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">7</property>
                    <property name="name">itemctgyseq</property>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="position">8</property>
                    <property name="name">question</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">9</property>
                    <property name="name">choice1</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">10</property>
                    <property name="name">choice2</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">11</property>
                    <property name="name">choice3</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">12</property>
                    <property name="name">choice4</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">13</property>
                    <property name="name">choice5</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">14</property>
                    <property name="name">choice6</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">15</property>
                    <property name="name">choice7</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">16</property>
                    <property name="name">choice8</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">17</property>
                    <property name="name">answer</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">18</property>
                    <property name="name">useranswer</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">19</property>
                    <property name="name">mark</property>
                    <property name="dataType">integer</property>
                </structure>
            </list-property>
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">formid</property>
                    <text-property name="displayName">准考证</text-property>
                </structure>
                <structure>
                    <property name="columnName">name</property>
                    <text-property name="displayName">姓名</text-property>
                </structure>
                <structure>
                    <property name="columnName">gender</property>
                    <text-property name="displayName">性别</text-property>
                </structure>
                <structure>
                    <property name="columnName">totalmark</property>
                    <text-property name="displayName">分数</text-property>
                </structure>
                <structure>
                    <property name="columnName">seq</property>
                    <text-property name="displayName">序号</text-property>
                </structure>
                <structure>
                    <property name="columnName">itemcategory</property>
                    <text-property name="displayName">题型</text-property>
                </structure>
                <structure>
                    <property name="columnName">itemctgyseq</property>
                    <text-property name="displayName">题号</text-property>
                </structure>
                <structure>
                    <property name="columnName">question</property>
                    <text-property name="displayName">题目</text-property>
                </structure>
                <structure>
                    <property name="columnName">choice1</property>
                    <text-property name="displayName">答题1</text-property>
                </structure>
                <structure>
                    <property name="columnName">choice2</property>
                    <text-property name="displayName">答题2</text-property>
                </structure>
                <structure>
                    <property name="columnName">choice3</property>
                    <text-property name="displayName">答题3</text-property>
                </structure>
                <structure>
                    <property name="columnName">choice4</property>
                    <text-property name="displayName">答案4</text-property>
                </structure>
                <structure>
                    <property name="columnName">choice5</property>
                    <text-property name="displayName">答案5</text-property>
                </structure>
                <structure>
                    <property name="columnName">choice6</property>
                    <text-property name="displayName">答案6</text-property>
                </structure>
                <structure>
                    <property name="columnName">choice7</property>
                    <text-property name="displayName">答案7</text-property>
                </structure>
                <structure>
                    <property name="columnName">choice8</property>
                    <text-property name="displayName">答案8</text-property>
                </structure>
                <structure>
                    <property name="columnName">answer</property>
                    <text-property name="displayName">答案</text-property>
                </structure>
                <structure>
                    <property name="columnName">useranswer</property>
                    <text-property name="displayName">考生答题</text-property>
                </structure>
                <structure>
                    <property name="columnName">mark</property>
                    <text-property name="displayName">得分</text-property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">formid</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">name</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">gender</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">totalmark</property>
                        <property name="dataType">float</property>
                    </structure>
                    <structure>
                        <property name="position">5</property>
                        <property name="name">seq</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">6</property>
                        <property name="name">itemcategory</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">7</property>
                        <property name="name">itemctgyseq</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">8</property>
                        <property name="name">question</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">9</property>
                        <property name="name">choice1</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">10</property>
                        <property name="name">choice2</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">11</property>
                        <property name="name">choice3</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">12</property>
                        <property name="name">choice4</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">13</property>
                        <property name="name">choice5</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">14</property>
                        <property name="name">choice6</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">15</property>
                        <property name="name">choice7</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">16</property>
                        <property name="name">choice8</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">17</property>
                        <property name="name">answer</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">18</property>
                        <property name="name">useranswer</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">19</property>
                        <property name="name">mark</property>
                        <property name="dataType">integer</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">DS</property>
            <method name="open"><![CDATA[
importPackage(Packages.com.dgpx.rpt);

ejbClient = new ExamPaperReport();
ejbClient.setEJB(params["JNDIName"]);

master = ejbClient.getEntity(params["id"]);
list = ejbClient.getDetail(params["id"]);

currentRow = 0;]]></method>
            <method name="fetch"><![CDATA[

if(currentRow<list.size()){
	dataSetRow["formid"] = master.getFormid();
	dataSetRow["name"] = master.getName();
	dataSetRow["gender"] = master.getGender();
	dataSetRow["totalmark"] = master.getMark();
	dataSetRow["seq"] = list.get(currentRow).getSeq();
	dataSetRow["itemcategory"] = list.get(currentRow).getItemcategory().getName();
	dataSetRow["itemctgyseq"] = list.get(currentRow).getItemctgyseq();
	dataSetRow["question"] = list.get(currentRow).getQuestion();
	dataSetRow["choice1"] = "A:"+list.get(currentRow).getChoice1();
	dataSetRow["choice2"] = "B:"+list.get(currentRow).getChoice2();
	if(list.get(currentRow).getChoice3()!=""){
		dataSetRow["choice3"] = "C:"+list.get(currentRow).getChoice3();
	}
	if(list.get(currentRow).getChoice4()!=""){
		dataSetRow["choice4"] = "D:"+list.get(currentRow).getChoice4();
	}
	if(list.get(currentRow).getChoice5()!=""){
		dataSetRow["choice5"] = "E:"+list.get(currentRow).getChoice5();
	}
	if(list.get(currentRow).getChoice6()!=""){
		dataSetRow["choice6"] = "F:"+list.get(currentRow).getChoice6();
	}
	if(list.get(currentRow).getChoice7()!=""){
		dataSetRow["choice7"] = "G:"+list.get(currentRow).getChoice7();
	}
	if(list.get(currentRow).getChoice8()!=""){
		dataSetRow["choice8"] = "H:"+list.get(currentRow).getChoice8();
	}	
	dataSetRow["answer"] = list.get(currentRow).getAnswer();
	dataSetRow["useranswer"] = list.get(currentRow).getUseranswer();		
	currentRow++;
	return true;	
}
return false;]]></method>
            <method name="close"><![CDATA[
ejbClient = null;]]></method>
        </script-data-set>
    </data-sets>
    <page-setup>
        <simple-master-page name="Simple MasterPage" id="2">
            <property name="type">a4</property>
            <page-footer>
                <text id="3">
                    <property name="contentType">html</property>
                    <text-property name="content"><![CDATA[<value-of>new Date()</value-of>]]></text-property>
                </text>
            </page-footer>
        </simple-master-page>
    </page-setup>
    <body>
        <label id="6">
            <property name="fontFamily">"Microsoft YaHei"</property>
            <property name="fontSize">18pt</property>
            <property name="textAlign">center</property>
            <text-property name="text">上海市进网作业电工考核中心</text-property>
        </label>
        <grid id="153">
            <property name="width">7.722222222222222in</property>
            <list-property name="boundDataColumns">
                <structure>
                    <property name="name">mark</property>
                    <text-property name="displayName">分数</text-property>
                    <expression name="expression" type="javascript">dataSetRow["mark"]</expression>
                    <property name="dataType">float</property>
                </structure>
                <structure>
                    <property name="name">formid</property>
                    <text-property name="displayName">准考证</text-property>
                    <expression name="expression" type="javascript">dataSetRow["formid"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">name</property>
                    <text-property name="displayName">姓名</text-property>
                    <expression name="expression" type="javascript">dataSetRow["name"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">gender</property>
                    <text-property name="displayName">性别</text-property>
                    <expression name="expression" type="javascript">dataSetRow["gender"]</expression>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <column id="154">
                <property name="width">0.9in</property>
            </column>
            <column id="187">
                <property name="width">0.9in</property>
            </column>
            <column id="193">
                <property name="width">0.9in</property>
            </column>
            <column id="197">
                <property name="width">0.9in</property>
            </column>
            <column id="183">
                <property name="width">0.9in</property>
            </column>
            <column id="155">
                <property name="width">1.2916666666666667in</property>
            </column>
            <column id="209">
                <property name="width">0.9in</property>
            </column>
            <column id="156">
                <property name="width">0.9in</property>
            </column>
            <row id="157">
                <cell id="158">
                    <property name="verticalAlign">top</property>
                    <label id="205">
                        <text-property name="text"> </text-property>
                    </label>
                </cell>
                <cell id="184"/>
                <cell id="190"/>
                <cell id="194"/>
                <cell id="180"/>
                <cell id="159"/>
                <cell id="206"/>
                <cell id="160"/>
            </row>
            <row id="161">
                <cell id="162">
                    <label id="188">
                        <property name="fontSize">12pt</property>
                        <property name="textAlign">right</property>
                        <text-property name="text">姓名:</text-property>
                    </label>
                </cell>
                <cell id="185">
                    <data id="201">
                        <property name="fontSize">12pt</property>
                        <property name="dataSet">dataDetail</property>
                        <list-property name="boundDataColumns">
                            <structure>
                                <property name="name">name</property>
                                <text-property name="displayName">姓名</text-property>
                                <expression name="expression" type="javascript">dataSetRow["name"]</expression>
                                <property name="dataType">string</property>
                            </structure>
                        </list-property>
                        <property name="resultSetColumn">name</property>
                    </data>
                </cell>
                <cell id="191">
                    <label id="198">
                        <property name="fontSize">12pt</property>
                        <property name="textAlign">right</property>
                        <text-property name="text">性别:</text-property>
                    </label>
                </cell>
                <cell id="195">
                    <data id="202">
                        <property name="fontSize">12pt</property>
                        <property name="dataSet">dataDetail</property>
                        <list-property name="boundDataColumns">
                            <structure>
                                <property name="name">gender</property>
                                <text-property name="displayName">性别</text-property>
                                <expression name="expression" type="javascript">dataSetRow["gender"]</expression>
                                <property name="dataType">string</property>
                            </structure>
                        </list-property>
                        <property name="resultSetColumn">gender</property>
                    </data>
                </cell>
                <cell id="181">
                    <label id="189">
                        <property name="fontSize">12pt</property>
                        <property name="textAlign">right</property>
                        <text-property name="text">准考证:</text-property>
                    </label>
                </cell>
                <cell id="163">
                    <data id="204">
                        <property name="fontSize">12pt</property>
                        <property name="dataSet">dataDetail</property>
                        <list-property name="boundDataColumns">
                            <structure>
                                <property name="name">formid</property>
                                <text-property name="displayName">准考证</text-property>
                                <expression name="expression" type="javascript">dataSetRow["formid"]</expression>
                                <property name="dataType">string</property>
                            </structure>
                        </list-property>
                        <property name="resultSetColumn">formid</property>
                    </data>
                </cell>
                <cell id="207">
                    <label id="210">
                        <property name="fontSize">12pt</property>
                        <property name="textAlign">right</property>
                        <text-property name="text">成绩:</text-property>
                    </label>
                </cell>
                <cell id="164">
                    <data id="200">
                        <property name="fontSize">12pt</property>
                        <property name="dataSet">dataDetail</property>
                        <list-property name="boundDataColumns">
                            <structure>
                                <property name="name">totalmark</property>
                                <text-property name="displayName">分数</text-property>
                                <expression name="expression" type="javascript">dataSetRow["totalmark"]</expression>
                                <property name="dataType">string</property>
                            </structure>
                        </list-property>
                        <property name="resultSetColumn">totalmark</property>
                    </data>
                </cell>
            </row>
            <row id="165">
                <cell id="166">
                    <label id="223"/>
                </cell>
                <cell id="186"/>
                <cell id="192"/>
                <cell id="196"/>
                <cell id="182"/>
                <cell id="167"/>
                <cell id="208"/>
                <cell id="168"/>
            </row>
        </grid>
        <table id="130">
            <property name="width">7.722222222222222in</property>
            <property name="dataSet">dataDetail</property>
            <list-property name="boundDataColumns">
                <structure>
                    <property name="name">itemctgyseq</property>
                    <text-property name="displayName">题号</text-property>
                    <expression name="expression" type="javascript">dataSetRow["itemctgyseq"]</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">question</property>
                    <text-property name="displayName">题目</text-property>
                    <expression name="expression" type="javascript">dataSetRow["question"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">choice1</property>
                    <text-property name="displayName">答题1</text-property>
                    <expression name="expression" type="javascript">dataSetRow["choice1"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">choice2</property>
                    <text-property name="displayName">答题2</text-property>
                    <expression name="expression" type="javascript">dataSetRow["choice2"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">choice3</property>
                    <text-property name="displayName">答题3</text-property>
                    <expression name="expression" type="javascript">dataSetRow["choice3"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">choice4</property>
                    <text-property name="displayName">答案4</text-property>
                    <expression name="expression" type="javascript">dataSetRow["choice4"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">choice5</property>
                    <text-property name="displayName">答案5</text-property>
                    <expression name="expression" type="javascript">dataSetRow["choice5"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">choice6</property>
                    <text-property name="displayName">答案6</text-property>
                    <expression name="expression" type="javascript">dataSetRow["choice6"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">answer</property>
                    <text-property name="displayName">答案</text-property>
                    <expression name="expression" type="javascript">dataSetRow["answer"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">useranswer</property>
                    <text-property name="displayName">考生答题</text-property>
                    <expression name="expression" type="javascript">dataSetRow["useranswer"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">itemcategory</property>
                    <text-property name="displayName">题型</text-property>
                    <expression name="expression" type="javascript">dataSetRow["itemcategory"]</expression>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <column id="231">
                <property name="width">0.75in</property>
            </column>
            <column id="141"/>
            <column id="214">
                <property name="width">0.6in</property>
            </column>
            <column id="218">
                <property name="width">0.6in</property>
            </column>
            <header>
                <row id="131">
                    <cell id="228">
                        <label id="232">
                            <text-property name="text">题型</text-property>
                        </label>
                    </cell>
                    <cell id="133">
                        <label id="144">
                            <property name="textAlign">left</property>
                            <text-property name="text">题目</text-property>
                        </label>
                    </cell>
                    <cell id="211">
                        <label id="219">
                            <text-property name="text">答案</text-property>
                        </label>
                    </cell>
                    <cell id="215">
                        <label id="221">
                            <text-property name="text">答题</text-property>
                        </label>
                    </cell>
                </row>
            </header>
            <detail>
                <row id="134">
                    <cell id="229">
                        <data id="233">
                            <property name="textAlign">center</property>
                            <property name="resultSetColumn">itemcategory</property>
                        </data>
                        <data id="143">
                            <property name="fontFamily">serif</property>
                            <property name="textAlign">center</property>
                            <property name="resultSetColumn">itemctgyseq</property>
                        </data>
                    </cell>
                    <cell id="136">
                        <data id="145">
                            <property name="resultSetColumn">question</property>
                        </data>
                        <data id="146">
                            <property name="resultSetColumn">choice1</property>
                        </data>
                        <data id="147">
                            <property name="resultSetColumn">choice2</property>
                        </data>
                        <data id="148">
                            <property name="resultSetColumn">choice3</property>
                        </data>
                        <data id="149">
                            <property name="resultSetColumn">choice4</property>
                        </data>
                        <data id="150">
                            <property name="resultSetColumn">choice5</property>
                        </data>
                        <data id="151">
                            <property name="resultSetColumn">choice6</property>
                        </data>
                    </cell>
                    <cell id="212">
                        <data id="220">
                            <property name="textAlign">center</property>
                            <property name="resultSetColumn">answer</property>
                        </data>
                    </cell>
                    <cell id="216">
                        <data id="222">
                            <property name="textAlign">center</property>
                            <property name="resultSetColumn">useranswer</property>
                        </data>
                    </cell>
                </row>
            </detail>
            <footer>
                <row id="137">
                    <cell id="230"/>
                    <cell id="139"/>
                    <cell id="213"/>
                    <cell id="217"/>
                </row>
            </footer>
        </table>
    </body>
</report>
